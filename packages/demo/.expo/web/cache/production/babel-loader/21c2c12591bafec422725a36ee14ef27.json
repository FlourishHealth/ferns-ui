{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import XDate from'xdate';import React,{forwardRef,useImperativeHandle,useEffect,useRef,useState,useContext,useCallback}from'react';import Animated from\"react-native-web/dist/exports/Animated\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import{getDefaultLocale}from'../../services';import{toMarkingFormat}from'../../interface';import{isToday,isPastDate}from'../../dateutils';import{UpdateSources,todayString}from'../commons';import styleConstructor from'../style';import Context from'./index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TOP_POSITION=65;var DOWN_ICON=require('../../img/down.png');var UP_ICON=require('../../img/up.png');var TodayButton=function TodayButton(props,ref){useImperativeHandle(ref,function(){return{disable:function disable(shouldDisable){_disable(shouldDisable);}};});var _props$margin=props.margin,margin=_props$margin===void 0?0:_props$margin,_props$disabledOpacit=props.disabledOpacity,disabledOpacity=_props$disabledOpacit===void 0?0.3:_props$disabledOpacit,theme=props.theme,propsStyle=props.style;var _useContext=useContext(Context),date=_useContext.date,setDate=_useContext.setDate;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),disabled=_useState2[0],setDisabled=_useState2[1];var style=useRef(styleConstructor(theme));var state=isToday(date)?0:isPastDate(date)?-1:1;var shouldShow=state!==0;useEffect(function(){if(shouldShow){setButtonIcon(getButtonIcon());}animatePosition();},[state]);useEffect(function(){if(!shouldShow){return;}animateOpacity();},[disabled]);var _disable=function _disable(shouldDisable){if(shouldDisable!==disabled){setDisabled(shouldDisable);}};var getFormattedLabel=function getFormattedLabel(){var todayStr=getDefaultLocale().today||todayString;var today=todayStr.charAt(0).toUpperCase()+todayStr.slice(1);return today;};var today=useRef(getFormattedLabel());var getButtonIcon=function getButtonIcon(){if(shouldShow){return state===1?UP_ICON:DOWN_ICON;}};var _useState3=useState(getButtonIcon()),_useState4=_slicedToArray(_useState3,2),buttonIcon=_useState4[0],setButtonIcon=_useState4[1];var buttonY=useRef(new Animated.Value(margin?-margin:-TOP_POSITION));var opacity=useRef(new Animated.Value(1));var getPositionAnimation=function getPositionAnimation(){var toValue=state===0?TOP_POSITION:-margin||-TOP_POSITION;return{toValue:toValue,tension:30,friction:8,useNativeDriver:true};};var getOpacityAnimation=function getOpacityAnimation(){return{toValue:disabled?disabledOpacity:1,duration:500,useNativeDriver:true};};var animatePosition=function animatePosition(){var animationData=getPositionAnimation();Animated.spring(buttonY.current,_objectSpread({},animationData)).start();};var animateOpacity=function animateOpacity(){var animationData=getOpacityAnimation();Animated.timing(opacity.current,_objectSpread({},animationData)).start();};var getTodayDate=function getTodayDate(){return toMarkingFormat(new XDate());};var onPress=useCallback(function(){setDate(getTodayDate(),UpdateSources.TODAY_PRESS);},[setDate]);return _jsx(Animated.View,{style:[style.current.todayButtonContainer,{transform:[{translateY:buttonY.current}]}],children:_jsxs(TouchableOpacity,{style:[style.current.todayButton,propsStyle],onPress:onPress,disabled:disabled,children:[_jsx(Animated.Image,{style:[style.current.todayButtonImage,{opacity:opacity.current}],source:buttonIcon}),_jsx(Animated.Text,{allowFontScaling:false,style:[style.current.todayButtonText,{opacity:opacity.current}],children:today.current})]})});};export default forwardRef(TodayButton);","map":{"version":3,"names":["XDate","React","forwardRef","useImperativeHandle","useEffect","useRef","useState","useContext","useCallback","Animated","TouchableOpacity","getDefaultLocale","toMarkingFormat","isToday","isPastDate","UpdateSources","todayString","styleConstructor","Context","jsx","_jsx","jsxs","_jsxs","TOP_POSITION","DOWN_ICON","require","UP_ICON","TodayButton","props","ref","disable","shouldDisable","_props$margin","margin","_props$disabledOpacit","disabledOpacity","theme","propsStyle","style","_useContext","date","setDate","_useState","_useState2","_slicedToArray","disabled","setDisabled","state","shouldShow","setButtonIcon","getButtonIcon","animatePosition","animateOpacity","getFormattedLabel","todayStr","today","charAt","toUpperCase","slice","_useState3","_useState4","buttonIcon","buttonY","Value","opacity","getPositionAnimation","toValue","tension","friction","useNativeDriver","getOpacityAnimation","duration","animationData","spring","current","_objectSpread","start","timing","getTodayDate","onPress","TODAY_PRESS","View","todayButtonContainer","transform","translateY","children","todayButton","Image","todayButtonImage","source","Text","allowFontScaling","todayButtonText"],"sources":["/Users/josh/src/ui/node_modules/react-native-calendars/src/expandableCalendar/Context/todayButton.js"],"sourcesContent":["import XDate from 'xdate';\nimport React, { forwardRef, useImperativeHandle, useEffect, useRef, useState, useContext, useCallback } from 'react';\nimport { Animated, TouchableOpacity } from 'react-native';\nimport { getDefaultLocale } from '../../services';\nimport { toMarkingFormat } from '../../interface';\nimport { isToday, isPastDate } from '../../dateutils';\nimport { UpdateSources, todayString } from '../commons';\nimport styleConstructor from '../style';\nimport Context from './index';\nconst TOP_POSITION = 65;\nconst DOWN_ICON = require('../../img/down.png');\nconst UP_ICON = require('../../img/up.png');\nconst TodayButton = (props, ref) => {\n    useImperativeHandle(ref, () => ({\n        disable: (shouldDisable) => {\n            disable(shouldDisable);\n        }\n    }));\n    const { margin = 0, disabledOpacity = 0.3, theme, style: propsStyle, } = props;\n    const { date, setDate } = useContext(Context);\n    const [disabled, setDisabled] = useState(false);\n    const style = useRef(styleConstructor(theme));\n    const state = isToday(date) ? 0 : isPastDate(date) ? -1 : 1;\n    const shouldShow = state !== 0;\n    /** Effects */\n    useEffect(() => {\n        if (shouldShow) {\n            setButtonIcon(getButtonIcon());\n        }\n        animatePosition();\n    }, [state]);\n    useEffect(() => {\n        if (!shouldShow) {\n            return;\n        }\n        animateOpacity();\n    }, [disabled]);\n    const disable = (shouldDisable) => {\n        if (shouldDisable !== disabled) {\n            setDisabled(shouldDisable);\n        }\n    };\n    /** Label */\n    const getFormattedLabel = () => {\n        const todayStr = getDefaultLocale().today || todayString;\n        const today = todayStr.charAt(0).toUpperCase() + todayStr.slice(1);\n        return today;\n    };\n    const today = useRef(getFormattedLabel());\n    /** Icon */\n    const getButtonIcon = () => {\n        if (shouldShow) {\n            return state === 1 ? UP_ICON : DOWN_ICON;\n        }\n    };\n    const [buttonIcon, setButtonIcon] = useState(getButtonIcon());\n    /** Animations */\n    const buttonY = useRef(new Animated.Value(margin ? -margin : -TOP_POSITION));\n    const opacity = useRef(new Animated.Value(1));\n    const getPositionAnimation = () => {\n        const toValue = state === 0 ? TOP_POSITION : -margin || -TOP_POSITION;\n        return {\n            toValue,\n            tension: 30,\n            friction: 8,\n            useNativeDriver: true\n        };\n    };\n    const getOpacityAnimation = () => {\n        return {\n            toValue: disabled ? disabledOpacity : 1,\n            duration: 500,\n            useNativeDriver: true\n        };\n    };\n    const animatePosition = () => {\n        const animationData = getPositionAnimation();\n        Animated.spring(buttonY.current, {\n            ...animationData\n        }).start();\n    };\n    const animateOpacity = () => {\n        const animationData = getOpacityAnimation();\n        Animated.timing(opacity.current, {\n            ...animationData\n        }).start();\n    };\n    const getTodayDate = () => {\n        return toMarkingFormat(new XDate());\n    };\n    const onPress = useCallback(() => {\n        setDate(getTodayDate(), UpdateSources.TODAY_PRESS);\n    }, [setDate]);\n    return (<Animated.View style={[style.current.todayButtonContainer, { transform: [{ translateY: buttonY.current }] }]}>\n      <TouchableOpacity style={[style.current.todayButton, propsStyle]} onPress={onPress} disabled={disabled}>\n        <Animated.Image style={[style.current.todayButtonImage, { opacity: opacity.current }]} source={buttonIcon}/>\n        <Animated.Text allowFontScaling={false} style={[style.current.todayButtonText, { opacity: opacity.current }]}>\n          {today.current}\n        </Animated.Text>\n      </TouchableOpacity>\n    </Animated.View>);\n};\nexport default forwardRef(TodayButton);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}