{"ast":null,"code":"'use strict';\n\nimport { Animations, customAnimations } from './config';\nvar WEB_ANIMATIONS_ID = 'ReanimatedWebAnimationsStyle';\nexport function configureWebLayoutAnimations() {\n  if (document.getElementById(WEB_ANIMATIONS_ID) !== null) {\n    return;\n  }\n  var style = document.createElement('style');\n  style.id = WEB_ANIMATIONS_ID;\n  style.onload = function () {\n    if (!style.sheet) {\n      console.error('[Reanimated] Failed to create layout animations stylesheet');\n      return;\n    }\n    for (var animationName in Animations) {\n      style.sheet.insertRule(Animations[animationName].style);\n    }\n  };\n  document.head.appendChild(style);\n}\nexport function insertWebAnimation(animationName, keyframe) {\n  var styleTag = document.getElementById(WEB_ANIMATIONS_ID);\n  if (!styleTag.sheet) {\n    console.error('[Reanimated] Failed to create layout animations stylesheet');\n    return;\n  }\n  var customTransitionId = styleTag.sheet.insertRule(keyframe);\n  customAnimations.set(animationName, customTransitionId);\n}\nfunction removeWebAnimation(animationName) {\n  var _styleTag$sheet;\n  if (!customAnimations.has(animationName)) {\n    return;\n  }\n  var styleTag = document.getElementById(WEB_ANIMATIONS_ID);\n  (_styleTag$sheet = styleTag.sheet) === null || _styleTag$sheet === void 0 ? void 0 : _styleTag$sheet.deleteRule(customAnimations.get(animationName));\n  customAnimations.delete(animationName);\n}\nvar timeoutScale = 1.25;\nvar frameDurationMs = 16;\nvar minimumFrames = 10;\nexport function scheduleAnimationCleanup(animationName, animationDuration) {\n  var timeoutValue = Math.max(animationDuration * timeoutScale * 1000, animationDuration + frameDurationMs * minimumFrames);\n  setTimeout(function () {\n    return removeWebAnimation(animationName);\n  }, timeoutValue);\n}\nexport function areDOMRectsEqual(r1, r2) {\n  return r1.x === r2.x && r1.y === r2.y && r1.width === r2.width && r1.height === r2.height;\n}","map":{"version":3,"names":["Animations","customAnimations","WEB_ANIMATIONS_ID","configureWebLayoutAnimations","document","getElementById","style","createElement","id","onload","sheet","console","error","animationName","insertRule","head","appendChild","insertWebAnimation","keyframe","styleTag","customTransitionId","set","removeWebAnimation","_styleTag$sheet","has","deleteRule","get","delete","timeoutScale","frameDurationMs","minimumFrames","scheduleAnimationCleanup","animationDuration","timeoutValue","Math","max","setTimeout","areDOMRectsEqual","r1","r2","x","y","width","height"],"sources":["/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/web/domUtils.ts"],"sourcesContent":["'use strict';\n\nimport { Animations, customAnimations } from './config';\nimport type { AnimationNames } from './config';\n\nconst WEB_ANIMATIONS_ID = 'ReanimatedWebAnimationsStyle';\n\n/**\n *  Creates `HTMLStyleElement`, inserts it into DOM and then inserts CSS rules into the stylesheet.\n *  If style element already exists, nothing happens.\n */\nexport function configureWebLayoutAnimations() {\n  if (document.getElementById(WEB_ANIMATIONS_ID) !== null) {\n    return;\n  }\n\n  const style = document.createElement('style');\n  style.id = WEB_ANIMATIONS_ID;\n\n  style.onload = () => {\n    if (!style.sheet) {\n      console.error(\n        '[Reanimated] Failed to create layout animations stylesheet'\n      );\n      return;\n    }\n\n    for (const animationName in Animations) {\n      style.sheet.insertRule(Animations[animationName as AnimationNames].style);\n    }\n  };\n\n  document.head.appendChild(style);\n}\n\nexport function insertWebAnimation(animationName: string, keyframe: string) {\n  const styleTag = document.getElementById(\n    WEB_ANIMATIONS_ID\n  ) as HTMLStyleElement;\n\n  if (!styleTag.sheet) {\n    console.error('[Reanimated] Failed to create layout animations stylesheet');\n    return;\n  }\n\n  const customTransitionId = styleTag.sheet.insertRule(keyframe);\n  customAnimations.set(animationName, customTransitionId);\n}\n\nfunction removeWebAnimation(animationName: string) {\n  if (!customAnimations.has(animationName)) {\n    return;\n  }\n\n  const styleTag = document.getElementById(\n    WEB_ANIMATIONS_ID\n  ) as HTMLStyleElement;\n\n  styleTag.sheet?.deleteRule(customAnimations.get(animationName) as number);\n  customAnimations.delete(animationName);\n}\n\nconst timeoutScale = 1.25; // We use this value to enlarge timeout duration. It can prove useful if animation lags.\nconst frameDurationMs = 16; // Just an approximation.\nconst minimumFrames = 10;\n\nexport function scheduleAnimationCleanup(\n  animationName: string,\n  animationDuration: number\n) {\n  // If duration is very short, we want to keep remove delay to at least 10 frames\n  // In our case it is exactly 160/1099 s, which is approximately 0.15s\n  const timeoutValue = Math.max(\n    animationDuration * timeoutScale * 1000,\n    animationDuration + frameDurationMs * minimumFrames\n  );\n\n  setTimeout(() => removeWebAnimation(animationName), timeoutValue);\n}\n\nexport function areDOMRectsEqual(r1: DOMRect, r2: DOMRect) {\n  // There are 4 more fields, but checking these should suffice\n  return (\n    r1.x === r2.x &&\n    r1.y === r2.y &&\n    r1.width === r2.width &&\n    r1.height === r2.height\n  );\n}\n"],"mappings":"AAAA,YAAY;;AAEZ,SAASA,UAAU,EAAEC,gBAAgB,QAAQ,UAAU;AAGvD,IAAMC,iBAAiB,GAAG,8BAA8B;AAMxD,OAAO,SAASC,4BAA4BA,CAAA,EAAG;EAC7C,IAAIC,QAAQ,CAACC,cAAc,CAACH,iBAAiB,CAAC,KAAK,IAAI,EAAE;IACvD;EACF;EAEA,IAAMI,KAAK,GAAGF,QAAQ,CAACG,aAAa,CAAC,OAAO,CAAC;EAC7CD,KAAK,CAACE,EAAE,GAAGN,iBAAiB;EAE5BI,KAAK,CAACG,MAAM,GAAG,YAAM;IACnB,IAAI,CAACH,KAAK,CAACI,KAAK,EAAE;MAChBC,OAAO,CAACC,KAAK,CACX,4DAA4D,CAC7D;MACD;IACF;IAEA,KAAK,IAAMC,aAAa,IAAIb,UAAU,EAAE;MACtCM,KAAK,CAACI,KAAK,CAACI,UAAU,CAACd,UAAU,CAACa,aAAa,CAAmB,CAACP,KAAK,CAAC;IAC3E;EACF,CAAC;EAEDF,QAAQ,CAACW,IAAI,CAACC,WAAW,CAACV,KAAK,CAAC;AAClC;AAEA,OAAO,SAASW,kBAAkBA,CAACJ,aAAqB,EAAEK,QAAgB,EAAE;EAC1E,IAAMC,QAAQ,GAAGf,QAAQ,CAACC,cAAc,CACtCH,iBAAiB,CACE;EAErB,IAAI,CAACiB,QAAQ,CAACT,KAAK,EAAE;IACnBC,OAAO,CAACC,KAAK,CAAC,4DAA4D,CAAC;IAC3E;EACF;EAEA,IAAMQ,kBAAkB,GAAGD,QAAQ,CAACT,KAAK,CAACI,UAAU,CAACI,QAAQ,CAAC;EAC9DjB,gBAAgB,CAACoB,GAAG,CAACR,aAAa,EAAEO,kBAAkB,CAAC;AACzD;AAEA,SAASE,kBAAkBA,CAACT,aAAqB,EAAE;EAAA,IAAAU,eAAA;EACjD,IAAI,CAACtB,gBAAgB,CAACuB,GAAG,CAACX,aAAa,CAAC,EAAE;IACxC;EACF;EAEA,IAAMM,QAAQ,GAAGf,QAAQ,CAACC,cAAc,CACtCH,iBAAiB,CACE;EAErB,CAAAqB,eAAA,GAAAJ,QAAQ,CAACT,KAAK,cAAAa,eAAA,uBAAdA,eAAA,CAAgBE,UAAU,CAACxB,gBAAgB,CAACyB,GAAG,CAACb,aAAa,CAAC,CAAW;EACzEZ,gBAAgB,CAAC0B,MAAM,CAACd,aAAa,CAAC;AACxC;AAEA,IAAMe,YAAY,GAAG,IAAI;AACzB,IAAMC,eAAe,GAAG,EAAE;AAC1B,IAAMC,aAAa,GAAG,EAAE;AAExB,OAAO,SAASC,wBAAwBA,CACtClB,aAAqB,EACrBmB,iBAAyB,EACzB;EAGA,IAAMC,YAAY,GAAGC,IAAI,CAACC,GAAG,CAC3BH,iBAAiB,GAAGJ,YAAY,GAAG,IAAI,EACvCI,iBAAiB,GAAGH,eAAe,GAAGC,aAAa,CACpD;EAEDM,UAAU,CAAC;IAAA,OAAMd,kBAAkB,CAACT,aAAa,CAAC;EAAA,GAAEoB,YAAY,CAAC;AACnE;AAEA,OAAO,SAASI,gBAAgBA,CAACC,EAAW,EAAEC,EAAW,EAAE;EAEzD,OACED,EAAE,CAACE,CAAC,KAAKD,EAAE,CAACC,CAAC,IACbF,EAAE,CAACG,CAAC,KAAKF,EAAE,CAACE,CAAC,IACbH,EAAE,CAACI,KAAK,KAAKH,EAAE,CAACG,KAAK,IACrBJ,EAAE,CAACK,MAAM,KAAKJ,EAAE,CAACI,MAAM;AAE3B"},"metadata":{},"sourceType":"module","externalDependencies":[]}